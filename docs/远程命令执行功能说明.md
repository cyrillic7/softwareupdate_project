# 远程命令执行功能说明

## 功能概述

QtProject.exe主程序新增了"远程命令执行"功能，提供类似SSH终端的界面，允许用户在远程Linux服务器上执行自定义命令并实时查看输出结果。

## 功能特性

### 🖥️ 终端体验
- **命令行界面**：类似SSH终端的黑色背景界面
- **实时输出**：命令执行过程实时显示
- **彩色显示**：不同类型信息使用不同颜色区分
- **自动滚动**：输出自动滚动到最新内容

### ⚡ 操作便捷
- **快捷输入**：支持回车键快速执行命令
- **历史显示**：所有执行过的命令和输出都保留
- **一键清空**：可随时清空输出历史
- **状态提示**：实时显示命令执行状态

### 🔒 安全可靠
- **SSH连接**：使用相同的服务器连接配置
- **权限控制**：使用配置的用户权限执行命令
- **错误处理**：完善的错误检测和提示
- **防重复执行**：避免同时执行多个命令

## 界面元素

### 命令输入区域
```
┌─────────────────────────────────────────────────────────┐
│ 命令: [输入框                              ] [执行命令] [清空输出] │
└─────────────────────────────────────────────────────────┘
```

### 输出显示区域
```
┌─────────────────────────────────────────────────────────┐
│ 命令输出:                                               │
├─────────────────────────────────────────────────────────┤
│ [12:34:56] $ ls -la                                     │
│ total 24                                                │
│ drwxr-xr-x 3 root root 4096 Jan 15 12:34 .             │
│ drwxr-xr-x 5 root root 4096 Jan 15 12:30 ..            │
│ -rw-r--r-- 1 root root 1024 Jan 15 12:34 qt_update.tar.gz │
│ [12:34:57] 命令执行完成 (退出码: 0)                     │
│ ---                                                     │
└─────────────────────────────────────────────────────────┘
```

## 使用方法

### 基本操作
1. **配置连接**：确保服务器连接信息已正确配置
2. **输入命令**：在命令输入框中输入要执行的Linux命令
3. **执行命令**：点击"执行命令"按钮或按回车键
4. **查看输出**：在输出区域实时查看命令执行结果

### 快捷操作
- **回车执行**：在命令输入框中按回车键快速执行
- **清空输出**：点击"清空输出"按钮清理历史记录
- **滚动查看**：使用鼠标滚轮查看历史输出

## 支持的命令类型

### 系统信息查询
```bash
# 查看系统信息
uname -a
cat /etc/os-release
uptime
free -h
df -h

# 进程管理
ps aux
top -bn1 | head -20
netstat -tulpn
```

### 文件操作
```bash
# 文件浏览
ls -la
ls -la /media/sata/ue_data/
find /mnt/qtfs -name "*.so"

# 文件查看
cat /proc/version
head -10 /var/log/syslog
tail -f /var/log/messages
```

### 网络检测
```bash
# 网络连接
ping -c 3 www.baidu.com
wget --spider http://www.google.com
curl -I http://httpbin.org/ip

# 端口检测
ss -tulpn | grep :22
netstat -an | grep LISTEN
```

### 服务管理
```bash
# 服务状态
systemctl status ssh
systemctl list-units --type=service
service --status-all

# 系统日志
journalctl -n 20
dmesg | tail -10
```

## 输出颜色说明

### 颜色含义
- 🔵 **蓝色** `#74b9ff`：时间戳和命令提示符
- ⚪ **白色** `#ffffff`：标准输出内容
- 🔴 **红色** `#ff7675`：错误输出内容
- 🟢 **绿色** `#00b894`：成功完成提示
- 🟠 **橙色** `#e17055`：警告或错误退出码
- 🔴 **深红** `#ff6b6b`：严重错误或异常
- 🔵 **青色** `#4ecdc4`：系统消息

### 输出格式示例
```
[12:34:56] $ ls -la                          # 蓝色 - 命令和时间戳
total 24                                     # 白色 - 正常输出
drwxr-xr-x 3 root root 4096 Jan 15 12:34 .  # 白色 - 正常输出
[12:34:57] 命令执行完成 (退出码: 0)          # 绿色 - 成功
---                                          # 蓝色 - 分割线
[12:35:01] $ cat nonexistent                 # 蓝色 - 命令和时间戳
cat: nonexistent: No such file or directory # 红色 - 错误输出
[12:35:02] 命令执行完成但有错误 (退出码: 1)  # 橙色 - 有错误
---                                          # 蓝色 - 分割线
```

## 常用命令示例

### Qt软件相关
```bash
# 检查Qt相关文件
find /mnt/qtfs -name "*.so" -type f
ls -la /mnt/qtfs/uebin/
file /mnt/qtfs/uebin/your_qt_app

# 进程检查
ps aux | grep qt
pgrep -f qt

# 权限检查
ls -la /media/sata/ue_data/
stat /mnt/qtfs/uebin/
```

### 系统维护
```bash
# 磁盘空间
df -h
du -sh /mnt/qtfs/*
lsblk

# 内存使用
free -h
cat /proc/meminfo | head -5

# 系统负载
uptime
top -bn1 | head -5
iostat 1 1
```

### 网络诊断
```bash
# 连接测试
ping -c 3 8.8.8.8
traceroute -n www.baidu.com
nc -zv 172.16.10.161 22

# 网络配置
ifconfig
ip addr show
route -n
```

## 错误处理

### 常见错误类型

#### 1. 命令不存在
**现象**：显示"command not found"
**解决**：
- 检查命令拼写是否正确
- 使用`which command_name`检查命令路径
- 确认命令是否已安装

#### 2. 权限不足
**现象**：显示"Permission denied"
**解决**：
- 使用sudo提升权限（如：`sudo ls /root`）
- 检查用户是否有相应权限
- 确认文件/目录的访问权限

#### 3. 文件不存在
**现象**：显示"No such file or directory"
**解决**：
- 检查文件路径是否正确
- 使用`ls`命令确认文件是否存在
- 检查文件名拼写

#### 4. 网络相关错误
**现象**：网络命令失败
**解决**：
- 检查网络连接状态
- 确认防火墙设置
- 验证DNS配置

## 最佳实践

### 使用建议
1. **先测试简单命令**：使用`ls`、`pwd`等简单命令测试连接
2. **避免交互式命令**：不要使用需要用户输入的命令
3. **合理使用sudo**：仅在必要时使用sudo权限
4. **注意输出长度**：避免执行输出过长的命令

### 安全注意事项
1. **谨慎执行危险命令**：避免使用`rm -rf`等危险命令
2. **不要泄露密码**：避免在命令中包含敏感信息
3. **定期清空输出**：清理可能包含敏感信息的输出
4. **权限最小化**：使用最小必要权限的用户账户

### 效率提升
1. **使用别名**：设置常用命令的别名
2. **组合命令**：使用管道和重定向组合命令
3. **批量操作**：将多个操作组合为一条命令
4. **结果过滤**：使用grep等工具过滤输出

## 技术细节

### SSH连接参数
```bash
ssh -o ConnectTimeout=30 \
    -o StrictHostKeyChecking=no \
    -o UserKnownHostsFile=/dev/null \
    -o PasswordAuthentication=yes \
    -p <端口> \
    <用户名>@<IP地址> \
    <命令>
```

### 进程管理
- **单进程执行**：同时只能执行一个命令
- **自动清理**：进程完成后自动清理资源
- **超时控制**：30秒连接超时保护
- **状态管理**：实时监控进程状态

### 输出处理
- **实时显示**：使用信号槽机制实时更新
- **格式保持**：保持原始输出格式
- **编码处理**：正确处理中文等字符
- **HTML格式**：使用HTML标签显示颜色

## 版本信息

- **功能版本**：v1.0.0
- **支持平台**：Windows 10/11
- **Qt版本**：5.12.12
- **依赖工具**：SSH客户端

---

**提示**：此功能提供强大的远程命令执行能力，请谨慎使用，避免执行可能损害系统的命令。建议先在测试环境中熟悉功能后再在生产环境使用。 